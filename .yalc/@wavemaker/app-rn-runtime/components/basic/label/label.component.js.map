{"version":3,"names":["React","Text","View","BaseComponent","BaseComponentState","Tappable","NavigationServiceConsumer","AccessibilityWidgetType","getAccessibilityProps","WmLabelProps","DEFAULT_CLASS","isNil","toString","Animatedview","createSkeleton","WmLabelState","constructor","arguments","_defineProperty","WmLabel","props","getAsterisk","createElement","style","styles","asterisk","onPropertyChange","name","$new","$old","updateState","parts","parseCaption","getMultilineSkeleton","width","height","borderRadius","marginBottom","theme","skeleton","caption","replace","pattern","linkRegex","captionSplit","split","i","length","isLink","test","part","isNextTextALink","text","link","push","renderSkeleton","_this$styles$root","_this$styles$root2","skeletonWidth","skeletonwidth","root","skeletonHeight","skeletonheight","fontSize","multilineskeleton","renderWidget","linkStyles","mergeStyle","entryanimation","animation","_background","navigationService","_this$state$parts","_this$state$parts2","target","_extends","state","flexWrap","textAlign","getTestPropsForLabel","numberOfLines","nooflines","ellipsizeMode","map","index","key","isValid","color","selectable","userSelect","onPress","startsWith","openUrl","eventName","substring","invokeEventCallback","proxy","LABEL","required"],"sources":["label.component.tsx"],"sourcesContent":["import React from 'react';\nimport { DimensionValue, Text, View } from 'react-native';\nimport { BaseComponent, BaseComponentState } from '@wavemaker/app-rn-runtime/core/base.component';\nimport { Tappable } from '@wavemaker/app-rn-runtime/core/tappable.component';\nimport NavigationService, { NavigationServiceConsumer } from '@wavemaker/app-rn-runtime/core/navigation.service';\nimport { AccessibilityWidgetType, getAccessibilityProps } from '@wavemaker/app-rn-runtime/core/accessibility';\n\nimport WmLabelProps from './label.props';\nimport { DEFAULT_CLASS, WmLabelStyles } from './label.styles';\nimport { isNil, toString } from 'lodash-es';\nimport { Animatedview } from '@wavemaker/app-rn-runtime/components/basic/animatedview.component';\nimport WmSkeleton, { createSkeleton } from '../skeleton/skeleton.component';\n\ntype PartType = {\n  text?: string,\n  link?: string,\n};\n\nexport class WmLabelState extends BaseComponentState<WmLabelProps> {\n  parts: PartType[] = []\n}\n\nexport default class WmLabel extends BaseComponent<WmLabelProps, WmLabelState, WmLabelStyles> {\n\n  constructor(props: WmLabelProps) {\n    super(props, DEFAULT_CLASS, new WmLabelProps(), new WmLabelState());\n  }\n\n  private getAsterisk () {\n    return <Text style={this.styles.asterisk}>*</Text>;\n  }\n\n  public onPropertyChange(name: string, $new: any, $old: any): void {\n    super.onPropertyChange(name, $new, $old);\n\n    switch(name) {\n      case \"caption\":\n        this.updateState({\n          parts: this.parseCaption($new)\n        } as WmLabelState);\n        break;\n    }\n  }\n  private getMultilineSkeleton(width: any, height: any) {\n    const styles = {\n      borderRadius:4,\n      marginBottom: 10,\n      height: height\n    };\n    return createSkeleton(this.theme, this.styles.skeleton, {\n      ...styles,\n      width: width,\n      height: height\n    });\n  }\n\n  parseCaption(caption: string) {\n    if (!caption) {\n      return [];\n    }\n    caption += '';\n    caption = caption.replace(/\\s*\\(\\s*\\$event,\\s*\\$widget\\s*\\)\\s*/, '');\n    caption = caption.replace(/\\(\\s*\\)/, '(#/__EMPTY__)');\n    const pattern = /\\[([^\\]]+)\\]\\(([^)]*)\\)/g;\n    const linkRegex = /^(((http|https):\\/\\/)|javascript:|#).+$/;\n    const captionSplit = caption.split(pattern);\n\n    let parts = [];\n\n    for (let i = 0; i < captionSplit.length; i++) {\n      const isLink = linkRegex.test(captionSplit[i]);\n      let part: PartType = {};\n      \n      const isNextTextALink = linkRegex.test(captionSplit[i + 1]);\n      if (isLink) {\n        part.text = captionSplit[i - 1] ?? '';\n        part.link = captionSplit[i] === '#/__EMPTY__' ? '' : captionSplit[i];\n      } else {\n        part.text = isNextTextALink ? \"\" : captionSplit[i];\n      };\n\n      if (part.text) {\n        parts.push(part);\n      }\n    }\n\n    return parts;\n  }\n\n  public renderSkeleton(props: WmLabelProps){\n    const skeletonWidth = this.props.skeletonwidth || this.styles.root?.width;\n    const skeletonHeight = this.props.skeletonheight || this.styles.root?.height || this.styles.text.fontSize;\n    if(this.props.multilineskeleton) {\n      return (<View style={{\n        width: skeletonWidth as DimensionValue\n      }}>\n        {this.getMultilineSkeleton('100%', skeletonHeight)}\n        {this.getMultilineSkeleton('70%', skeletonHeight)}\n        {this.getMultilineSkeleton('40%', skeletonHeight)}\n      </View>)\n    }\n    else{\n      return createSkeleton(this.theme, this.styles.skeleton, {\n        ...this.styles.root,\n        width: skeletonWidth as DimensionValue,\n        height: skeletonHeight as DimensionValue\n      });  \n    }\n  }\n\n  renderWidget(props: WmLabelProps) {\n    const linkStyles = this.theme.mergeStyle({text: this.styles.text}, this.styles.link);\n    return !isNil(props.caption) ? (\n      <Animatedview entryanimation={props.animation} style={this.styles.root}>\n        {this._background}\n        <NavigationServiceConsumer>\n        {(navigationService: NavigationService) => {\n          return (<Tappable target={this}>\n            <Text style={ this.state.parts.length <= 1 ? this.styles.text : {flexWrap: \"wrap\", textAlign: this.styles.text.textAlign}}\n              {...this.state.parts.length <= 1 ? this.getTestPropsForLabel('caption') : {}}\n              numberOfLines={props.nooflines} ellipsizeMode=\"tail\">\n              {this.state.parts?.length === 1 ? this.state.props.caption : this.state.parts?.map((part, index) => {\n                const isLink = !isNil(part.link);\n                return (\n                  <Text\n                    key={`part_${index}`}\n                    style={[\n                      this.styles.text,\n                      isLink ? this.styles.link.text : null,\n                      props.isValid ? null : { color: 'red'}\n                    ]}\n                    {...this.getTestPropsForLabel(isLink ? `link_${index}` : `caption_${index}`)}\n                    selectable={this.styles.text.userSelect === 'text'}\n                    onPress={() => {\n                      if (part.link) { \n                        if (part.link.startsWith('http:')\n                          || part.link.startsWith('https:')\n                          || part.link.startsWith('#')) {\n                          navigationService.openUrl(part.link, '_blank');\n                        } else if (part.link.startsWith('javascript:')) {\n                          const eventName = part.link.substring(11);\n                          this.invokeEventCallback(eventName, [null, this.proxy]);\n                        }\n                      }\n                      this.invokeEventCallback('onTap', [null, this.proxy]);\n                    }}\n                    {...getAccessibilityProps(AccessibilityWidgetType.LABEL, props)}\n                  >\n                    {toString(part.text)}\n                    {props.required && this.getAsterisk()}\n                  </Text>\n                );\n              })}\n            </Text>\n          </Tappable>)}}\n        </NavigationServiceConsumer>\n      </Animatedview>\n    ) : null;\n  }\n}\n"],"mappings":"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"}