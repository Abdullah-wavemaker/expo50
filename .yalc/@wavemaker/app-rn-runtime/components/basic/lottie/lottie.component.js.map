{"version":3,"names":["React","axios","Platform","View","LottieView","BaseComponent","BaseComponentState","WmLottieProps","DEFAULT_CLASS","WmLottieState","constructor","arguments","_defineProperty","WmLottie","props","createRef","play","lottie","current","state","isCompleted","reset","invokeEventCallback","proxy","pause","goToAndPlay","updateState","onReady","autoplay","loadAnimationData","animationData","loadAsset","OS","url","source","get","then","_ref","data","onPropertyChange","name","$new","$old","initialized","setTimeout","componentDidMount","renderWebLottie","Lottie","require","createElement","ref","loop","speed","style","styles","onComplete","renderNativeLottie","autoPlay","onAnimationFinish","renderWidget","root","_background"],"sources":["lottie.component.tsx"],"sourcesContent":["import React from 'react';\nimport axios from 'axios';\nimport { Platform, View } from 'react-native';\nimport LottieView from 'lottie-react-native';\nimport { BaseComponent, BaseComponentState } from '@wavemaker/app-rn-runtime/core/base.component';\n\nimport WmLottieProps from './lottie.props';\nimport { DEFAULT_CLASS, WmLottieStyles } from './lottie.styles';\n\nexport class WmLottieState extends BaseComponentState<WmLottieProps> {\n  animationData: any;\n  isCompleted = false;\n}\n\nexport default class WmLottie extends BaseComponent<WmLottieProps, WmLottieState, WmLottieStyles> {\n\n  private lottie = React.createRef<LottieView>();\n\n  constructor(props: WmLottieProps) {\n    super(props, DEFAULT_CLASS, new WmLottieProps(), new WmLottieState());\n  }\n  \n  play() {\n    if (this.lottie.current) {\n      if (this.state.isCompleted) {\n        this.reset();\n      } else {\n        this.lottie.current.play();\n        this.invokeEventCallback('onPlay', [null, this.proxy]);\n      }\n    }\n  }\n\n  pause() {\n    if (this.lottie.current) {\n      this.lottie.current.pause();\n      this.invokeEventCallback('onPause', [null, this.proxy]);\n    }\n  }\n\n  reset() {\n    if (this.lottie.current) {\n      if (this.lottie.current.reset) {\n        this.lottie.current.reset();\n        this.lottie.current.play();\n      } else if((this.lottie.current as any).goToAndPlay) {\n        (this.lottie.current as any).goToAndPlay(0);\n      } else {\n        return;\n      }\n      this.invokeEventCallback('onPlay', [null, this.proxy]);\n      this.updateState({\n        isCompleted: false\n      } as WmLottieState);\n    }\n    \n  }\n\n  private onReady() {\n    this.invokeEventCallback('onReady', [null, this.proxy]);\n    if (this.state.props.autoplay) {\n      this.invokeEventCallback('onPlay', [null, this.proxy]);\n    }\n  }\n\n  private loadAnimationData() {\n    if (this.state.animationData || ! this.loadAsset) {\n      return;\n    }\n    if (Platform.OS == 'web') {\n      const url = this.loadAsset(this.state.props.source) as string;\n      axios.get(url).then(({data}) => {\n        this.updateState({\n          animationData: data\n        } as WmLottieState, () => this.onReady());\n      });\n    } else {\n      this.updateState({\n        animationData: this.loadAsset(this.state.props.source)\n      } as WmLottieState, () => this.onReady());\n    }\n  }\n\n  onPropertyChange(name: string, $new: any, $old: any): void {\n    super.onPropertyChange(name, $new, $old);\n    switch(name) {\n      case 'src':\n        this.loadAnimationData();\n        break;\n      case 'loop':\n        if (this.initialized && \n          !this.state.isCompleted && \n          ($new || this.state.props.autoplay)) {\n          setTimeout(() => this.reset(), 200);\n        }\n        break;\n    }\n  }\n\n  componentDidMount(): void {\n    super.componentDidMount();\n    this.loadAnimationData();\n  }\n\n  private renderWebLottie(props: WmLottieProps) {\n    const Lottie = require('react-lottie-player');\n    return (<Lottie \n      animationData={this.state.animationData}\n      ref= {this.lottie}\n      loop={props.loop}\n      play={props.autoplay}\n      speed={props.speed}\n      style={this.styles.lottie}\n      onComplete={() => {\n        this.updateState({\n          isCompleted: true\n        } as WmLottieState);\n        this.invokeEventCallback('onComplete', [null, this.proxy]);\n      }}/>);\n  }\n\n  private renderNativeLottie(props: WmLottieProps) {\n    return (\n      <LottieView\n          source={this.state.animationData}\n          ref= {this.lottie}\n          autoPlay={props.autoplay}\n          speed={props.speed}\n          loop={props.loop}\n          style={this.styles.lottie} \n          onAnimationFinish={() => {\n            this.updateState({\n              isCompleted: true\n            } as WmLottieState);\n            this.invokeEventCallback('onComplete', [null, this.proxy]);\n          }}\n        />\n    );\n  }\n\n  renderWidget(props: WmLottieProps) {\n    return (\n      <View style={this.styles.root}>\n        {this._background}\n        {this.state.animationData ? \n          (Platform.OS == 'web' ?  this.renderWebLottie(props) : this.renderNativeLottie(props)) \n          : null \n        }\n      </View>); \n  }\n}\n"],"mappings":"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"}