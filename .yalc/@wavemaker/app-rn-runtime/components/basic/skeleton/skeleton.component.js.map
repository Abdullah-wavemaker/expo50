{"version":3,"names":["React","View","Animated","Easing","StyleSheet","LinearGradient","BaseComponent","BaseComponentState","WmSkeletonProps","DEFAULT_CLASS","isUndefined","WmSkeletonState","constructor","arguments","_defineProperty","left","top","width","height","AnimationRunner","Value","run","counter","timing","animationValue","duration","time","speed","toValue","useNativeDriver","easing","linear","start","event","finished","setValue","stop","Math","max","getValue","WmSkeleton","props","_this$skeletonloaderR","skeletonloaderRef","measure","x","y","px","py","layout","setState","animate","componentDidMount","animationRunner","componentWillUnmount","renderWidget","_this$styles$gradient","_this$styles$gradient2","_this$styles$gradient3","outpuRange","state","deg","translateX","interpolate","inputRange","outputRange","createElement","ref","onLayout","onLayoutChange","style","styles","root","absoluteFill","animatedView","transform","rotate","end","colors","gradientForeground","backgroundColor","toString","gradient","locations","createSkeleton","theme","skeletonStyles","wrapper","addStyleProp","propName","mergeStyle"],"sources":["skeleton.component.tsx"],"sourcesContent":["import React from 'react';\nimport { View, Animated, Easing, StyleSheet, LayoutChangeEvent, ColorValue, ViewStyle } from 'react-native';\nimport { LinearGradient } from 'expo-linear-gradient';\n\nimport { BaseComponent, BaseComponentState } from '@wavemaker/app-rn-runtime/core/base.component';\nimport { Theme } from '@wavemaker/app-rn-runtime/styles/theme';\n\nimport WmSkeletonProps from './skeleton.props';\nimport { DEFAULT_CLASS, WmSkeletonStyles } from './skeleton.styles';\nimport { isUndefined } from 'lodash-es';\n\nexport class WmSkeletonState extends BaseComponentState<WmSkeletonProps> {\n  layout = {\n    left: 0,\n    top: 0,\n    width: 0,\n    height: 0,\n  };\n  animate = false;\n}\n\nclass AnimationRunner {\n  private time: number = 1000;\n  public speed = 1;\n  private counter = 0;\n  private animationValue = new Animated.Value(0.2);\n\n  public run() {\n    if (this.counter == 0) {\n      return;\n    }\n    Animated.timing(this.animationValue, {\n      duration: this.time * this.speed,\n      toValue: 1,\n      useNativeDriver: true,\n      easing: Easing.linear,\n    }).start((event) => {\n      if (event.finished) {\n        this.animationValue.setValue(0)\n        this.run();\n      }\n    });\n  }\n\n  public start() {\n    this.counter++;\n    if (this.counter == 1) {\n      this.run();\n    }\n  }\n\n  public stop() {\n    this.counter = Math.max(--this.counter, 0);\n  }\n\n  public getValue() {\n    return this.animationValue;\n  }\n}\n\nexport default class WmSkeleton extends BaseComponent<WmSkeletonProps, WmSkeletonState, WmSkeletonStyles> {\n\n  private skeletonloaderRef: any = null;\n  private animationRunner = new AnimationRunner();\n\n  constructor(props: WmSkeletonProps) {\n    super(props, DEFAULT_CLASS, new WmSkeletonProps(), new WmSkeletonState());\n  }\n\n  componentDidMount(): void {\n    this.animationRunner.start();\n  }\n\n  componentWillUnmount(): void {\n    this.animationRunner.stop();\n  }\n\n  onLayoutChange = (event: LayoutChangeEvent) => {\n    this.skeletonloaderRef?.measure((x: number, y: number, width: number, height: number, px: number, py: number) => {\n      let layout = {\n        left: px,\n        top: py,\n        width: width,\n        height: height,\n      };\n      this.setState({\n        layout: {\n          ...layout as any\n        }, animate: true\n      });\n    });\n  }\n\n  renderWidget(props: WmSkeletonProps) {\n    let outpuRange = [-this.state.layout.width-this.state.layout.left, this.state.layout.width + this.state.layout.height];\n    let deg = -20;\n    let translateX = this.animationRunner.getValue().interpolate({\n      inputRange: [0, 1],\n      outputRange: [-50, 400]\n    });\n    return (\n      <View ref={(ref) => { this.skeletonloaderRef = ref; }} onLayout={this.onLayoutChange}\n        style={this.styles.root} >\n        {this.state.animate ?\n          <Animated.View\n            style={[\n              StyleSheet.absoluteFill,\n              this.styles.animatedView,\n              { \n                transform: [\n                  { translateX },\n                  { rotate: deg + 'deg' }\n                ]\n              }]}>\n            <LinearGradient\n              start={{ x: 0, y: 0 }}\n              end={{ x: 1, y: 0 }}\n              colors={[this.styles.gradientForeground.backgroundColor?.toString() as string,\n              this.styles.gradient.backgroundColor?.toString() as string,\n              this.styles.gradientForeground.backgroundColor?.toString() as string]}\n              locations={[0, 0.5, 1]}\n              style={[this.styles.gradient, {backgroundColor: this.styles.animatedView.backgroundColor}]} />\n          </Animated.View> : null}\n      </View>);\n  }\n}\n\nexport const createSkeleton = (theme: Theme, skeletonStyles: WmSkeletonStyles, wrapper: ViewStyle) => {\n  const style = {} as ViewStyle;\n  const addStyleProp = (propName: any) => {\n    if (!isUndefined((wrapper as any)[propName])) {\n      (style as any)[propName] = (wrapper as any)[propName];\n    }\n  };\n  addStyleProp('width');\n  addStyleProp('height');\n  addStyleProp('borderRadius');\n  addStyleProp('borderRadius');\n  addStyleProp('marginTop');\n  addStyleProp('marginBottom');\n  addStyleProp('marginLeft');\n  addStyleProp('marginRight');\n  return(<WmSkeleton styles={theme.mergeStyle(skeletonStyles, {root: style})}/>);\n};\n"],"mappings":"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"}