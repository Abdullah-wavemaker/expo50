{"version":3,"names":["React","TouchableOpacity","Animated","Easing","BackgroundComponent","BaseComponent","BaseComponentState","unStringify","validateField","AccessibilityWidgetType","getAccessibilityProps","WmToggleProps","DEFAULT_CLASS","WmToggleState","constructor","arguments","_defineProperty","WmToggle","props","Value","onPropertyChange","name","$new","$old","value","state","checkedvalue","updateState","isSwitchOn","updateDatavalue","datavalue","validate","validationObj","isValid","errorType","onToggleSwitch","oldValue","dataValue","uncheckedvalue","sequence","timing","scaleValue","toValue","duration","useNativeDriver","animationValue","easing","linear","start","onFieldChange","invokeEventCallback","proxy","onLayoutChange","event","width","nativeEvent","layout","setState","viewWidth","renderWidget","styles","theme","mergeStyle","getStyle","createElement","_extends","onLayout","e","TOGGLE","selected","onPress","disabled","setTimeout","readonly","getTestPropsForAction","style","root","_background","View","handle","transform","translateX","interpolate","inputRange","outputRange","scale","size","backgroundSize","position","backgroundPosition","image","backgroundImage","repeat","backgroundRepeat"],"sources":["toggle.component.tsx"],"sourcesContent":["import React from 'react';\nimport { TouchableOpacity, Animated, Easing, LayoutChangeEvent } from 'react-native';\n\nimport { BackgroundComponent } from '@wavemaker/app-rn-runtime/styles/background.component';\nimport { BaseComponent, BaseComponentState } from '@wavemaker/app-rn-runtime/core/base.component';\nimport { unStringify, validateField} from '@wavemaker/app-rn-runtime/core/utils';\nimport { AccessibilityWidgetType, getAccessibilityProps } from '@wavemaker/app-rn-runtime/core/accessibility'; \n\nimport WmToggleProps from './toggle.props';\nimport { DEFAULT_CLASS, WmToggleStyles } from './toggle.styles';\n\nexport class WmToggleState extends BaseComponentState<WmToggleProps> {\n  isSwitchOn: boolean = false;\n  isValid: boolean = true;\n  errorType = '';\n  viewWidth: number = 0;\n}\n\nexport default class WmToggle extends BaseComponent<WmToggleProps, WmToggleState, WmToggleStyles> {\n\n  private animationValue = new Animated.Value(0);\n  private scaleValue = new Animated.Value(1);\n\n  constructor(props: WmToggleProps) {\n    super(props, DEFAULT_CLASS, new WmToggleProps(), new WmToggleState());\n  }\n\n  onPropertyChange(name: string, $new: any, $old: any) {\n    switch (name) {\n      case 'datavalue':\n        let value =\n          unStringify($new) ===\n          unStringify(this.state.props.checkedvalue, true);\n        this.updateState({ isSwitchOn: value } as WmToggleState);\n        break;\n    }\n  }\n\n  updateDatavalue(value: any) {\n    this.updateState({ props: { datavalue: value }} as WmToggleState);\n  }\n\n  validate(value: any) {\n    const validationObj = validateField(this.state.props, value);\n    this.updateState({\n      isValid: validationObj.isValid,\n      errorType: validationObj.errorType\n    } as WmToggleState);\n  }\n\n  onToggleSwitch(value: any) {\n    const oldValue = this.state.props.datavalue;\n    this.validate(value);\n    this.updateState({ isSwitchOn: value } as WmToggleState);\n    const dataValue = value === true ? this.state.props.checkedvalue : this.state.props.uncheckedvalue;\n    Animated.sequence([\n      Animated.timing(this.scaleValue, {\n        toValue: 1.6,\n        duration: 300,\n        useNativeDriver: true,\n      }),\n      Animated.timing(this.animationValue, {\n        toValue: value ? 1 : 0,\n        duration: 300,\n        easing: Easing.linear,\n        useNativeDriver: true,\n      }),\n    ]).start(() => {\n      Animated.timing(this.scaleValue, {\n        toValue: value ? 1.5 : 1,\n        duration: 0,\n        useNativeDriver: true,\n      }).start();\n    });\n    // @ts-ignore\n    this.updateState({ props: { datavalue: dataValue } },\n      ()=> {\n        if (!this.props.onFieldChange) {\n          this.invokeEventCallback('onChange', [null, this.proxy, dataValue, oldValue]);\n        } else {\n          this.props.onFieldChange && this.props.onFieldChange('datavalue', dataValue, oldValue);\n        }\n        this.invokeEventCallback('onBlur', [ null, this.proxy ]);\n      });\n  }\n\n  onLayoutChange(event: LayoutChangeEvent){\n    let width = event.nativeEvent.layout.width;\n    this.setState({\n      viewWidth: width,\n    } as WmToggleState);\n  }\n\n  renderWidget(props: WmToggleProps) {\n    const styles = this.theme.mergeStyle(this.styles, \n      this.theme.getStyle(this.state.isSwitchOn ? 'app-toggle-on' : 'app-toggle-off'));\n    return (\n      <TouchableOpacity \n      onLayout={(e) => {\n        this.onLayoutChange(e);\n      }}\n      {...getAccessibilityProps(AccessibilityWidgetType.TOGGLE, {...this.props, selected: this.state.isSwitchOn})}\n      onPress={() => {\n        if (this.props.disabled) {\n          return;\n        }\n        // Added setTimeout to smooth animation\n        setTimeout(() => {\n          if (!props.readonly) {\n            this.invokeEventCallback('onFocus', [null, this]);\n          }\n          this.invokeEventCallback('onTap', [null, this]);\n        }, 500);\n        this.onToggleSwitch(!this.state.isSwitchOn);\n      }}{...this.getTestPropsForAction()}\n      style={styles.root}>\n        {this._background}\n        <Animated.View\n         style={[\n          styles.handle,\n          {\n            transform: [\n              {\n                translateX: this.animationValue.interpolate({\n                  inputRange: [0, 1],\n                  outputRange: [0, this.state.viewWidth - (this.styles.handle.width as number+ 18)],\n                }),\n              },\n              {scale : this.scaleValue}\n            ],\n          },\n        ]}>\n          <BackgroundComponent\n            size={styles.handle.backgroundSize || 'contain'}\n            position={styles.handle.backgroundPosition}\n            image={styles.handle.backgroundImage}\n            repeat={styles.handle.backgroundRepeat || 'no-repeat'}>  \n          </BackgroundComponent>\n        </Animated.View>\n      </TouchableOpacity>\n    );\n  }\n}\n"],"mappings":"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"}