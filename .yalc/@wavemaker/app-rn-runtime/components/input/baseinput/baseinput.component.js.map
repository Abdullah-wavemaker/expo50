{"version":3,"names":["DEFAULT_CLASS","BaseComponent","BaseComponentState","isString","Platform","validateField","Injector","BaseInputState","constructor","arguments","_defineProperty","BaseInputComponent","props","defaultClass","length","undefined","defaultProps","defaultState","focus","_this$widgetRef","widgetRef","blur","_this$widgetRef2","_this$widgetRef3","onPropertyChange","name","$new","$old","keyboardType","type","updateState","textValue","isDefault","state","onFieldChange","bind","onChange","event","updateon","updateDatavalue","target","value","onChangeText","validate","invokeChange","e","OS","cursor","selectionStart","setState","source","oldValue","datavalue","autotrim","trim","invokeEventCallback","proxy","onBlur","FOCUSED_ELEMENT","remove","isTouched","newVal","oldVal","setTimeout","triggerValidation","validationObj","isValid","errorType","onFocus","set","onKeyPress"],"sources":["baseinput.component.ts"],"sourcesContent":["import { DEFAULT_CLASS } from '@wavemaker/app-rn-runtime/components/navigation/basenav/basenav.styles';\nimport { BaseComponent, BaseComponentState } from '@wavemaker/app-rn-runtime/core/base.component';\nimport BaseInputProps from './baseinput.props';\nimport { isString } from 'lodash';\nimport { BaseInputStyles } from './baseinput.styles';\nimport { Platform, TextInput } from 'react-native';\nimport { validateField } from '@wavemaker/app-rn-runtime/core/utils';\nimport Injector from '@wavemaker/app-rn-runtime/core/injector';\n\nexport class BaseInputState <T extends BaseInputProps> extends BaseComponentState<T> {\n  keyboardType: any = 'default';\n  isValid: boolean = true;\n  textValue: string = '';\n  isDefault = false;\n  errorType: string = '';\n}\nexport abstract class BaseInputComponent< T extends BaseInputProps, S extends BaseInputState<T>, L extends BaseInputStyles> extends BaseComponent<T, S, L> {\n  public widgetRef: TextInput | null = null;\n  isTouched: boolean = false;\n  private cursor: any = 0;\n  constructor(props: T, public defaultClass: string = DEFAULT_CLASS, defaultProps?: T, defaultState?: S) {\n    super(props, defaultClass, defaultProps, defaultState);\n  }\n\n  focus() {\n    this?.widgetRef?.focus();\n  }\n\n  blur() {\n    this?.widgetRef?.blur && this?.widgetRef?.blur();\n  }\n\n  onPropertyChange(name: string, $new: any, $old: any) {\n    switch (name) {\n      case 'type':\n        let keyboardType;\n        if (this.props.type === 'number') {\n          keyboardType = 'numeric';\n        } else if (this.props.type === 'tel') {\n          keyboardType = 'phone-pad';\n        } else if (this.props.type === 'email') {\n          keyboardType = 'email-address';\n        }\n        this.updateState({\n          keyboardType: keyboardType,\n        } as S);\n        break;\n      case 'datavalue':\n        this.updateState({\n            textValue: $new\n          } as S\n        );\n        const isDefault = this.state.isDefault;\n        if (isDefault) {\n          this.updateState({ isDefault: false } as S, this.props.onFieldChange && this.props.onFieldChange.bind(this, 'datavalue', $new, $old, isDefault));\n        } else {\n          this.props.onFieldChange && this.props.onFieldChange('datavalue', $new, $old, isDefault);\n        }\n    }\n  }\n\n  onChange(event: any) {\n    if (this.state.props.updateon === 'default') {\n      this.updateDatavalue(event.target.value, event);\n    }\n  }\n\n  onChangeText(value: any) {\n    this.updateState({\n        textValue: value\n      } as S, () => {\n        if (this.state.props.updateon === 'default') {\n          this.validate(value);\n          this.updateDatavalue(value, null);\n        }\n      }\n    );\n  }\n\n  invokeChange(e: any) {\n    if (Platform.OS === 'web') {\n      this.cursor = e.target.selectionStart;\n      this.setState({ textValue: e.target.value });\n    }\n  }\n\n  updateDatavalue(value: any, event?: any, source?: any) {\n    const props = this.state.props;\n    const oldValue = props.datavalue;\n    if (value === oldValue) {\n      return;\n    }\n\n    // autotrim\n    if (props.autotrim && props.datavalue && isString(props.datavalue)) {\n      value = value.trim();\n    }\n\n    this.updateState({\n      props: {\n        datavalue: value\n      }\n    } as S, () => {\n        !this.props.onFieldChange && value !== oldValue && this.invokeEventCallback('onChange', [event, this.proxy, value, oldValue]);\n        if (source === 'blur') {\n          this.invokeEventCallback('onBlur', [ event, this.proxy]);\n        }\n    })\n\n  }\n\n  onBlur(event: any) {\n    Injector.FOCUSED_ELEMENT.remove();\n    this.isTouched = true;\n    let newVal = this.state.textValue;\n    let oldVal = this.state.props.datavalue || '';\n    this.validate(newVal);\n    if (newVal === '' || newVal == undefined) {\n      setTimeout(() => {\n        this.props.triggerValidation && this.props.triggerValidation();\n      },10)\n    }\n    if (this.state.props.updateon === 'blur') {\n      if (oldVal !== newVal) {\n        this.updateDatavalue(newVal, event, 'blur');\n      } else {\n        this.invokeEventCallback('onBlur', [event, this.proxy]);\n      }\n    }\n  }\n\n  validate(value: any) {\n    const validationObj = validateField(this.state.props, value);\n    this.setState({\n      isValid: validationObj.isValid,\n      errorType: validationObj.errorType\n    } as S);\n  }\n\n  onFocus(event: any) {\n    // When input widgets are inside list widget and try to focus the field, list is selecting but unable to enter values in input fields\n    // because on tap event of list is triggering after 200ms timeout So added 250ms timeout here\n    setTimeout(() => {\n      Injector.FOCUSED_ELEMENT.set(this);\n      this.invokeEventCallback('onFocus', [ event, this.proxy]);\n    }, 250);\n\n  }\n\n  onKeyPress(event: any) {\n    this.invokeEventCallback('onKeypress', [ event, this.proxy]);\n  }\n}\n"],"mappings":"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"}