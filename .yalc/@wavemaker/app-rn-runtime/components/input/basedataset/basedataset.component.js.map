{"version":3,"names":["BaseComponent","BaseComponentState","find","isEqual","isFunction","includes","get","forEach","isObject","isArray","filter","trim","uniqBy","uniqWith","getGroupedData","getOrderedDataset","isDefined","validateField","DEFAULT_CLASS","BaseDatasetState","constructor","arguments","_defineProperty","BaseDatasetComponent","props","defaultClass","length","undefined","defaultProps","defaultState","onPropertyChange","name","$new","$old","state","setDataItems","dataset","setGroupData","dataItems","dataValue","isDefault","updateState","onFieldChange","bind","items","groupby","groupedData","match","orderby","dateformat","onDataItemsUpdate","validate","value","validationObj","setState","isValid","errorType","updateDatavalue","Promise","resolve","datavalue","computeDisplayValue","onValueChange","datafield","selectedItem","item","key","dataObject","onChange","getItemKey","oldValue","then","invokeEventCallback","proxy","displayValue","selected","map","displayexp","displayfield","getUniqObjsByDataField","data","allowEmptyFields","uniqData","isAllFields","obj","propsObj","allowEmpty","datavalueItems","split","s","i","toString","push","isSelected","df","d","datafieldValue","_get","_get2","displaylabel","getDisplayExpression","imgSrc","displayimagesrc","icon","iconclass","isUpdated"],"sources":["basedataset.component.ts"],"sourcesContent":["import { BaseComponent, BaseComponentState } from \"@wavemaker/app-rn-runtime/core/base.component\";\nimport BaseDatasetProps from '@wavemaker/app-rn-runtime/components/input/basedataset/basedataset.props';\nimport { find, isEqual,isEmpty, isFunction, includes, get, forEach, isObject, isArray, filter, trim, uniqBy, uniqWith } from 'lodash';\nimport { getGroupedData, getOrderedDataset, isDefined, validateField } from \"@wavemaker/app-rn-runtime/core/utils\";\nimport { DEFAULT_CLASS, BaseDatasetStyles } from \"@wavemaker/app-rn-runtime/components/input/basedataset/basedataset.styles\";\n\nexport class BaseDatasetState <T extends BaseDatasetProps> extends BaseComponentState<T> {\n  dataItems: any;\n  groupedData: any;\n  isDefault = false;\n  isValid = true;\n  errorType = '';\n}\n\nexport abstract class BaseDatasetComponent< T extends BaseDatasetProps, S extends BaseDatasetState<T>, L extends BaseDatasetStyles> extends BaseComponent<T, S, L> {\n\n  constructor(props: T, public defaultClass: string = DEFAULT_CLASS, defaultProps?: T, defaultState?: S) {\n    super(props, defaultClass, defaultProps, defaultState);\n\n  }\n\n  onPropertyChange(name: string, $new: any, $old: any) {\n    const props = this.state.props;\n    switch (name) {\n      case 'dataset':\n        this.setDataItems($new);\n        break;\n      case 'getDisplayExpression':\n      case 'displayfield':\n      case 'displaylabel':\n      case 'displayimagesrc':\n      case 'datafield':\n      case 'orderby':\n        this.setDataItems(this.state.props.dataset);\n        break;\n      case 'groupby':\n      case 'match':\n        this.setGroupData(this.state.dataItems);\n      case 'datavalue':\n        this.setDataItems(this.state.props.dataset, { dataValue: $new });\n        const isDefault = this.state.isDefault;\n        if (isDefault) {\n          this.updateState({ isDefault: false } as S, this.props.onFieldChange && this.props.onFieldChange.bind(this, 'datavalue', $new, $old, isDefault));\n        } else {\n          this.props.onFieldChange && this.props.onFieldChange('datavalue', $new, $old, isDefault);\n        }\n    }\n  }\n\n  setGroupData(items: any) {\n    const dataItems = items;\n    const props = this.state.props;\n    if (props.groupby) {\n      const groupedData = dataItems && getGroupedData(dataItems, props.groupby, props.match, props.orderby, props.dateformat, this, 'dataObject');\n      this.updateState({ groupedData: groupedData } as S, () => this.onDataItemsUpdate());\n    }\n  }\n\n  validate(value: any) {\n    const validationObj = validateField(this.state.props, value);\n    this.setState({\n      isValid: validationObj.isValid,\n      errorType: validationObj.errorType\n    } as S);\n  }\n\n  updateDatavalue(value: any) {\n    return new Promise<void>((resolve) => {\n      this.updateState({\n        props: { datavalue: value }\n       } as S,\n       () => {\n        this.computeDisplayValue();\n        resolve();\n       });\n    });\n  }\n\n  onValueChange(value: any) {\n    if (this.state.props.datafield === 'All Fields') {\n      const selectedItem = find(this.state.dataItems, (item) => isEqual(item.key, value));\n      value = selectedItem && selectedItem.dataObject;\n    }\n    this.onChange(value);\n  }\n\n  getItemKey(value: any) {\n      const selectedItem = find(this.state.dataItems, (item) => isEqual(item.dataObject, value));\n      return selectedItem && selectedItem.key;\n  }\n\n  onChange(value: any) {\n    const oldValue = this.state.props.datavalue;\n    this.validate(value);\n    this.updateDatavalue(value)\n    .then(() => {\n      if (value !== oldValue) {\n        if (this.props.onFieldChange) {\n          this.props.onFieldChange('datavalue', value, oldValue);\n        } else {\n          this.invokeEventCallback('onChange', [\n            undefined,\n            this.proxy,\n            value,\n            oldValue,\n          ]);\n        }\n      }\n    });\n  }\n\n  computeDisplayValue() {\n    this.updateState({\n      props: {\n        displayValue: ((this.state.dataItems || [] as any)\n          .filter((item: any) => item.selected)\n          .map((item: any) => item.displayexp || item.displayfield))[0] || ''\n      }\n    } as S);\n  }\n\n  onDataItemsUpdate() {\n    this.computeDisplayValue();\n  }\n\n  getUniqObjsByDataField(\n    data: any,\n    allowEmptyFields: boolean = true\n  ) {\n    let uniqData;\n    const isAllFields = this.state.props.datafield === 'All Fields';\n\n    uniqData = isAllFields ? uniqWith(data, isEqual) : uniqBy(data, 'datafield');\n\n    if (!this.state.props.displayfield || allowEmptyFields) {\n      return uniqData;\n    }\n\n    // return objects having non empty datafield and display field values.\n    return filter(uniqData, (obj) => {\n      if (isAllFields) {\n        return trim(obj.displayfield);\n      }\n      return trim(obj.datafield) && trim(obj.displayfield);\n    });\n  }\n\n  setDataItems(dataset: any, propsObj?: { [key: string]: any }, allowEmpty: boolean = true) {\n    const name = this.props.name;\n    const props = this.state.props;\n    const datavalue = propsObj ? propsObj['dataValue'] : props.datavalue;\n    let dataItems: any = [];\n    let datavalueItems: any = [];\n    if (typeof datavalue === 'string') {\n      datavalueItems = datavalue.split(',');\n      datavalueItems = allowEmpty ? datavalueItems : datavalueItems.map((item: any) => item.trim());\n    } else if (isArray(datavalue)) {\n      datavalueItems = datavalue;\n    } else {\n      if (isDefined(datavalue)) {\n        datavalueItems = [datavalue];\n      }\n    }\n    if (typeof dataset === 'string') {\n      dataset = dataset.split(',');\n    }\n    if (isArray(dataset) && !isObject(dataset[0])) {\n      dataItems = dataset.map((s, i) => {\n        s = s.trim();\n        return {\n          key: `${name}_item${i}`,\n          dataObject: s,\n          displayfield: s.toString(),\n          datafield: s,\n          selected: includes(datavalueItems, s) || includes(datavalueItems, s.toString()) || datavalue === s ? true : false,\n        };\n      });\n    } else if (dataset) {\n      if (isObject(dataset) && !isArray(dataset)) {\n        forEach(dataset, (value, key) => {\n          if (isDefined(key) && key !== null) {\n            dataItems.push({key: `${name}_item${key}`, displayfield: value, datafield: key, dataObject: dataset});\n          }\n        });\n      } else {\n        const isSelected = (item: any) => {\n          if (datavalueItems.length) {\n            let datafield = this.state.props.datafield;\n            if (!datafield) {\n              datafield = 'All Fields';\n            }\n            if (datafield === 'All Fields') {\n              return includes(datavalueItems, item);\n            }\n            let df = get(item, datafield);\n            if (isDefined(df) && df !== null) {\n              return (includes(datavalueItems, df) || includes(datavalueItems, df.toString()));\n            }\n          }\n          return false;\n        };\n        forEach(dataset as any[], (d, i) => {\n          let datafieldValue = this.state.props.datafield === 'All Fields' ? d : get(d, this.state.props.datafield);\n          if (isDefined(datafieldValue) && datafieldValue !== null) {\n            dataItems.push({\n              key: `${name}_item${i}`,\n              dataObject: d,\n              displayfield: (get(d, this.state.props.displayfield))?.toString() || (get(d, this.state.props.displaylabel))?.toString(),\n              datafield: datafieldValue,\n              displayexp: this.state.props.getDisplayExpression ? this.state.props.getDisplayExpression(d) : get(d, this.state.props.displayfield),\n              selected: isSelected(d),\n              imgSrc: isFunction(this.state.props.displayimagesrc) ? this.state.props.displayimagesrc(d) : get(d, this.state.props.displayimagesrc),\n              icon: d[this.props.iconclass]\n            });\n          }\n        });\n      }\n    }\n    if (dataItems.length) {\n      dataItems = this.getUniqObjsByDataField(dataItems, allowEmpty);\n    }\n    const isUpdated = !isEqual(dataItems, this.state.dataItems);\n    if (props.groupby) {\n      this.setGroupData(dataItems);\n      this.updateState({ dataItems: dataItems } as S, () => isUpdated && this.onDataItemsUpdate());\n    } else if (props.orderby) {\n      this.updateState({ dataItems: getOrderedDataset(dataItems, props.orderby, 'dataObject')} as S, () => isUpdated && this.onDataItemsUpdate());\n    } else {\n      this.updateState({ dataItems: dataItems } as S, () => isUpdated && this.onDataItemsUpdate());\n    }\n  }\n}\n"],"mappings":"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"}