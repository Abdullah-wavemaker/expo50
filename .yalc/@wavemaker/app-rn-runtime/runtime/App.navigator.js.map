{"version":3,"names":["React","Platform","View","NavigationContainer","DefaultTheme","isWebPreviewMode","injector","AppDrawerNavigator","AppStackNavigator","isEmpty","keys","last","ThemeVariables","getNavigationState","pageName","params","routes","name","state","index","getStateFromPath","path","options","hash","window","location","substring","startsWith","paramstr","split","forEach","p","k","v","getPathFromState","pagesRoute","pageRoute","href","map","join","setTimeout","_window$history$state","id","history","replaceState","AppNavigator","props","_appConfig$pages","appConfig","get","pages","linking","prefixes","appId","config","screens","undefined","navigationTheme","colors","background","INSTANCE","pageContentBgColor","stack","createElement","landingPage","leftNav","type","drawerAnimation","hide","hideDrawer","content","drawerContent","rootComponent","initialState","OS","landingPageParams","theme"],"sources":["App.navigator.tsx"],"sourcesContent":["import React, { ReactNode } from 'react';\nimport { Platform, View } from 'react-native';\nimport { NavigationContainer, DefaultTheme } from '@react-navigation/native';\nimport { isWebPreviewMode } from '@wavemaker/app-rn-runtime/core/utils';\nimport AppConfig from '@wavemaker/app-rn-runtime/core/AppConfig';\nimport injector from '@wavemaker/app-rn-runtime/core/injector';\nimport AppDrawerNavigator from './navigator/drawer.navigator';\nimport AppStackNavigator from './navigator/stack.navigator';\nimport { isEmpty, keys, last } from 'lodash';\nimport ThemeVariables from '../styles/theme.variables';\n\ndeclare const window: any;\n\nexport interface AppNavigatorProps {\n  drawerContent: () => ReactNode;\n  drawerAnimation: string;\n  hideDrawer: boolean;\n  landingPage?: string;\n  landingPageParams?: any;\n  app: any;\n}\n\nconst getNavigationState = (pageName: string, params: any) => {\n  return {\n    routes: [{\n      name: 'pages',\n      state: {\n        index: 0,\n        routes: [{\n          name: pageName,\n          params: params\n        }]\n      }\n    }]\n  };\n};\n\nconst getStateFromPath = (path: string, options?: any) => {\n  let hash: string = window.location.hash;\n  hash = hash.substring(1);\n  if (hash && hash.startsWith('/')) {\n    hash = hash.substring(1);\n  }\n  if (!hash) {\n    return;\n  }\n  let [pageName, paramstr] = hash.split('?');\n  let params = {} as any;\n  if (paramstr) {\n    paramstr.split('&').forEach((p) => {\n      const [k, v] = p.split('=');\n      params[k] = v;\n    });\n  }\n  return getNavigationState(pageName, params);\n};\n\nconst getPathFromState = (state: any, options: any) => {\n  const pagesRoute = state?.routes[0];\n  const pageRoute: any = last(pagesRoute?.state.routes);\n  let path = '';\n  if (pageRoute) {\n    path = window.location.href.split('#')[0] + '#/'+ pageRoute.name;\n    if (!isEmpty(pageRoute.params)) {\n      path += '?' + keys(pageRoute.params).map((k) => {\n        return `${k}=${pageRoute.params[k]}`\n      }).join('&');\n    }\n  }\n  setTimeout(() => {  \n    const id = window.history.state?.id;\n    window.history.replaceState({id}, null, path);\n  });\n  return path;\n};\n\nexport const AppNavigator = (props: AppNavigatorProps) => {\n  const appConfig = injector.get<AppConfig>('APP_CONFIG');\n  const pages = {};\n  const linking = {\n    prefixes: [`${appConfig.appId}://`],\n    config: {\n      screens: {\n        \"pages\": {\n          path: \"pages\",\n          screens: pages\n        }\n      }\n    },\n    getStateFromPath: isWebPreviewMode() ? getStateFromPath : undefined,\n    getPathFromState: isWebPreviewMode()? getPathFromState: undefined\n  } as any;\n\n  const navigationTheme = {\n    ...DefaultTheme,\n    colors: {\n      ...DefaultTheme.colors,\n      background: ThemeVariables.INSTANCE.pageContentBgColor\n    },\n  };\n  \n  appConfig.pages?.forEach((p) => {\n    //@ts-ignore\n    pages[p.name] = p.name;\n  });\n  const stack = (<AppStackNavigator\n    pages={appConfig.pages || []}\n    landingPage={appConfig.landingPage}></AppStackNavigator>);\n  const leftNav = (<AppDrawerNavigator\n      type={props.drawerAnimation === 'slide-over' ? 'front' : 'slide'}\n      hide={props.hideDrawer}\n      content={() => (props.drawerContent && props.drawerContent())  || (<View/>)}\n      rootComponent={stack}/>);\n      const initialState = props.landingPage && Platform.OS !== 'web' ? \n        getNavigationState(props.landingPage, props.landingPageParams)\n      : undefined;\n  return (<NavigationContainer initialState={initialState} linking={linking} theme={navigationTheme}>{leftNav}</NavigationContainer>);\n};\n"],"mappings":"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"}