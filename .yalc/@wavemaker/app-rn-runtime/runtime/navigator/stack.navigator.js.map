{"version":3,"names":["React","View","createStackNavigator","ThemeVariables","Stack","pages","Screen","Component","constructor","props","_defineProperty","state","renew","page","createPage","navigation","cleanUp","push","addListener","setState","createElement","route","name","component","destroyMe","setTimeout","componentWillUnmount","forEach","fn","render","getPageId","pageName","pageParams","pageParamsStr","Object","keys","sort","map","k","join","AppStackNavigator","Navigator","initialRouteName","landingPage","p","key","getId","_ref","params","options","headerShown","cardStyle","backgroundColor","INSTANCE","pageContentBgColor"],"sources":["stack.navigator.tsx"],"sourcesContent":["import React from 'react';\nimport { View } from 'react-native';\nimport { createStackNavigator } from '@react-navigation/stack';\nimport ThemeVariables from '@wavemaker/app-rn-runtime/styles/theme.variables';\n\nconst Stack = createStackNavigator();\n\ninterface AppStackNavigatorProps {\n  pages: any[];\n  landingPage: string; \n}\n\nconst pages = {} as any;\n\nclass Screen extends React.Component {\n\n  private cleanUp = [] as Function[];\n\n  constructor(props: any) {\n    super(props);\n    this.state = {\n      renew: false,\n      page: this.createPage()\n    };\n    const navigation = (this.props as any).navigation as any;\n    this.cleanUp.push(navigation.addListener('focus', () => {\n      const state = (this.state as any);\n      if (state.renew) {\n        state.page = this.createPage();\n        this.setState(() => ({\n          renew: false,\n          page: state.page\n        }));\n      }\n    }));\n  }\n\n  private createPage() {\n    const props = this.props as any;\n    return React.createElement(pages[props.route.name].component, {...props, destroyMe: () => {\n      setTimeout(() => {\n        this.setState(() => ({renew: true, page: null}));\n      }, 100);\n    }});\n  }\n\n  componentWillUnmount() {\n    this.cleanUp.forEach(fn => fn && fn());\n  }\n\n  render() {\n    return (this.state as any).page || (<View/>);\n  }\n}\n\nconst getPageId = (pageName: string, pageParams: any) => {\n  const pageParamsStr = pageParams ? Object.keys(pageParams)\n    .sort()\n    .map((k: string) => `${k}=${pageParams[k]}`)\n    .join('&') : '';\n  return `${pageName}?${pageParamsStr}`;\n}\n\nconst AppStackNavigator = (props: AppStackNavigatorProps) => {\n  return (<Stack.Navigator initialRouteName={props.landingPage}>\n    {props.pages.map(p => {\n      pages[p.name] = p;\n      return (\n        <Stack.Screen key={p.name}\n          name={p.name}\n          component={Screen}\n          getId={({params}) => getPageId(p.name, params)}\n          options={{\n            headerShown: false,\n            cardStyle: {\n              backgroundColor: ThemeVariables.INSTANCE.pageContentBgColor\n            }\n          }}\n        />);\n      })}\n  </Stack.Navigator>);\n};\n\nexport default AppStackNavigator;"],"mappings":"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"}