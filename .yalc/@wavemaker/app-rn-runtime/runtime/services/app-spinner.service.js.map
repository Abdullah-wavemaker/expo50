{"version":3,"names":["React","View","appDisplayManagerService","WmSpinner","ThemeVariables","AppSpinnerService","constructor","displayManager","_defineProperty","setImage","path","image","setDefaultOptions","options","defaultDisplayOptions","show","arguments","length","undefined","skeleton","spinner","loader","count","destroy","setTimeout","content","createElement","Fragment","style","styles","appSpinnerContainer","backgroundColor","INSTANCE","pageContentBgColor","caption","message","classname","lottie","delay","hide","call","justifyContent","alignItems","width","height","opacity","spinnerService"],"sources":["app-spinner.service.tsx"],"sourcesContent":["import React from 'react';\n\nimport { View, ViewStyle } from 'react-native';\n\nimport { SpinnerService, DisplayOptions } from '@wavemaker/app-rn-runtime/core/spinner.service';\nimport { DisplayManager } from '@wavemaker/app-rn-runtime/core/display.manager';\nimport appDisplayManagerService from '@wavemaker/app-rn-runtime/runtime/services/app-display-manager.service';\nimport WmSpinner from '@wavemaker/app-rn-runtime/components/basic/spinner/spinner.component';\nimport ThemeVariables from '@wavemaker/app-rn-runtime/styles/theme.variables';\n\nexport class AppSpinnerService implements SpinnerService {\n  public displayOptions = {} as DisplayOptions;\n  public destroy: any;\n  public delay = 0;\n  private count = 0;\n  private image: string = '';\n  public skeleton: boolean = false;\n  private defaultDisplayOptions: DisplayOptions =  {} as any;\n  constructor(private displayManager: DisplayManager) {}\n\n  setImage(path: string) {\n    this.image = path;\n  }\n\n  setDefaultOptions(options: DisplayOptions) {\n    this.defaultDisplayOptions = options;\n  }\n\n  show(options: DisplayOptions = this.defaultDisplayOptions) {\n    this.skeleton = options.spinner.loader == 'skeleton';\n    if (this.count === 0 && !this.destroy) { \n      setTimeout(() => {\n        const content = (<>\n          {!this.skeleton? \n            <View style={[styles.appSpinnerContainer, { backgroundColor: ThemeVariables.INSTANCE.pageContentBgColor }]}>\n              <WmSpinner\n                caption={options.message || ''}\n                classname=\"global-spinner\"\n                lottie={options.spinner}></WmSpinner>\n            </View> : null}\n            </>);\n        this.destroy = this.displayManager.show({ content: content });\n      }, this.delay);\n    }\n    this.count++;\n  }\n\n  hide() {\n    this.skeleton = false;\n    if (this.count > 0) {\n      this.count--;\n    } else {\n      this.count = 0;\n    }\n    if (this.count === 0) {\n      setTimeout(() => {\n        if (!this.count && this.destroy) {\n          this.destroy.call(this.displayManager);\n          this.destroy = null;\n        }\n      }, 300);\n    }\n  }\n}\n\nconst styles = {\n  appSpinnerContainer:{ \n    justifyContent: 'center', \n    alignItems: 'center', \n    width:'100%', \n    height:'100%',  \n    opacity: 0.8 \n  } as ViewStyle\n}\n\nconst spinnerService = new AppSpinnerService(appDisplayManagerService);\nexport default spinnerService;\n"],"mappings":"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"}