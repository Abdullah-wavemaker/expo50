{"version":3,"names":["React","Platform","View","get","injector","TouchableRipple","ParentTappableContext","createContext","SyntheticEvent","constructor","_defineProperty","stopPropagation","propagationEnabled","Tappable","Component","props","onPress","e","_this$props$target","lastPress","Date","now","target","onTouchStart","invokeEventCallback","currentTime","tapDelta","lastTap","isLongTap","_injector$FOCUSED_ELE","FOCUSED_ELEMENT","blur","lastDoubleTap","onDoubleTap","setTimeout","_this$parent","onTap","parent","onLongTap","_this$props$target2","_this$parent2","onPressOut","onTouchEnd","_this$props$target3","_this$parent3","setParent","render","onLongtap","onDoubletap","createElement","Consumer","Provider","value","_extends","rippleColor","borderless","OS","accessibilityLabel","testID","disabled","proxy","style","styles","onLongPress","Fragment","children"],"sources":["tappable.component.tsx"],"sourcesContent":["import { BaseComponent } from \"@wavemaker/app-rn-runtime/core/base.component\";\nimport React from \"react\";\nimport { GestureResponderEvent, Platform, View } from \"react-native\";\nimport { get } from \"lodash\";\nimport injector from \"./injector\";\nimport { TouchableRipple } from \"react-native-paper\";\nimport ThemeVariables from \"../styles/theme.variables\";\nimport { isDefined } from \"./utils\";\n\nexport const ParentTappableContext = React.createContext<Tappable>(null as any);\ninterface TappableProps {\n    testID?: string;\n    children?: any\n    styles?: any;\n    target?: BaseComponent<any, any, any>;\n    onTap?: (e: any) => void;\n    onLongTap?: (e: any) => void; \n    onDoubleTap?: (e: any) => void;\n    onTouchStart? : (e: any) => void;\n    onTouchEnd? : (e: any) => void;\n    rippleColor?: string;\n}\n\nexport class SyntheticEvent {\n    //\n    propagationEnabled = true;\n   \n    constructor() {\n\n    }\n\n    stopPropagation() {\n        this.propagationEnabled = false;\n    }\n}\n\nexport class Tappable extends React.Component<TappableProps, any> {\n    private lastPress = 0;\n    private lastTap = 0;\n    private lastDoubleTap = 0;\n    private isLongTap = false;\n    private parent:Tappable = null as any;\n   \n    constructor(props: any) {\n        super(props);\n    }\n\n    onPress(e: SyntheticEvent): void {   \n        this.lastPress = Date.now();\n        const target = this.props.target;\n        this.props.onTouchStart && this.props.onTouchStart(e);\n        this.props.target?.invokeEventCallback('onTouchstart', [e, this.props.target]);\n        const currentTime = Date.now();\n        const tapDelta = currentTime - this.lastTap;\n        if (this.isLongTap) {\n            this.isLongTap = false;\n            return;\n        }\n        if (e.propagationEnabled) {\n            injector.FOCUSED_ELEMENT.get()?.blur();\n            if(this.lastDoubleTap !== this.lastTap \n                && tapDelta < 500) {\n                this.props.onDoubleTap && this.props.onDoubleTap(e);\n                setTimeout(() => {\n                    target?.invokeEventCallback('onDoubletap', [e, target]);\n                }, 200);\n                this.lastDoubleTap = currentTime;\n            }\n            setTimeout(() => {\n                if (this.props.onTap) {\n                    this.props.onTap(e);\n                } else {\n                    target?.invokeEventCallback('onTap', [e, target]);\n                }\n                this.parent?.onPress(e);\n            }, 200);\n            this.lastTap = currentTime;\n        }\n    }\n\n    onLongTap(e: SyntheticEvent): void {\n        if(!e.propagationEnabled){\n            return;\n        }\n        this.props.onLongTap && this.props.onLongTap(e);\n        setTimeout(() => {\n            this.props.target?.invokeEventCallback('onLongtap', [e, this.props.target]);\n            this.parent?.onPressOut(e);\n        }, 200);\n        this.isLongTap = true;\n    }\n    \n    onPressOut(e: SyntheticEvent): void {\n        if(!e.propagationEnabled){\n            return;\n        } \n        this.props.onTouchEnd && this.props.onTouchEnd(e);\n        setTimeout(() => {\n            this.props.target?.invokeEventCallback('onTouchend', [e, this.props.target]);\n            this.parent?.onPressOut(e);\n        }, 200);\n        this.isLongTap = false;\n    }\n    private setParent(parent: Tappable) {\n        if (parent && this.parent !== parent)  {\n            this.parent = parent;\n        }\n    }\n\n    render() {\n        const target = this.props.target;\n        if (target?.props.onTap \n            || target?.props.onLongtap \n            || target?.props.onDoubletap \n            || this.props.onTap \n            || this.props.onLongTap \n            || this.props.onDoubleTap) {\n            return (\n                <ParentTappableContext.Consumer>{(parent) => {\n                    this.setParent(parent);\n                    return( <ParentTappableContext.Provider value={this}>\n                    <TouchableRipple\n                rippleColor={this.props.rippleColor}\n                borderless = {true}\n                 {...(Platform.OS === 'android' || Platform.OS === 'web') ? {\n                    accessibilityLabel: this.props.testID,\n                    testID: this.props.testID\n                }: {\n                    // accessible: false,\n                    testID: this.props.testID\n                }} \n                disabled={get(target?.proxy, 'disabled')}\n                style={this.props.styles}\n                onPress={(e?: GestureResponderEvent) => this.onPress(new SyntheticEvent())}\n                onLongPress={(e?: GestureResponderEvent) => this.onLongTap(new SyntheticEvent())}\n                onPressOut={(e?: GestureResponderEvent) => this.onPressOut(new SyntheticEvent())}>\n                    <>{this.props.children}</>\n                </TouchableRipple>\n                </ParentTappableContext.Provider>)}}</ParentTappableContext.Consumer>\n            \n            );\n        }\n        return (<View style={this.props.styles}>{this.props.children}</View>);\n    }\n}\n"],"mappings":"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"}