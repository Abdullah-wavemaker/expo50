{"version":3,"names":["BaseAction","TimerAction","constructor","config","_defineProperty","repeating","delay","invoke","options","success","error","fire","params","cancel","_schedulerID","clearInterval","clearTimeout","destroy","pause","trigger","repeatTimer","exec","onSuccess","setInterval","setTimeout","_isFired"],"sources":["timer-action.ts"],"sourcesContent":["import { ActionConfig, BaseAction } from \"./base-action\";\nexport interface TimerActionConfig extends ActionConfig {\n    repeating: Boolean;\n    delay: number;\n    onSuccess: any;\n}\nexport class TimerAction extends BaseAction<TimerActionConfig> {\n    repeating: Boolean;\n    _isFired = false;\n    _schedulerID: any = -1;\n    delay: number;\n    constructor(config: TimerActionConfig) {\n        super(config);\n        this.repeating = config.repeating;\n        this.delay = config.delay || 500;\n    }\n\n    invoke(options: any, success: any, error: any) {\n        super.invoke(options, success, error);\n        return this.fire(this.params, success, error) as any;\n    }\n\n    cancel() {\n        if (this._schedulerID > -1) {\n            if (this.repeating) {\n                clearInterval(this._schedulerID);\n            } else {\n                clearTimeout(this._schedulerID);\n            }\n            this._schedulerID = -1;\n        }\n    }\n\n    destroy() {\n        this.cancel();\n    }\n\n    pause() {\n        this.cancel();\n    }\n\n    trigger(options: any, success: any, error: any) {\n        if (this._schedulerID > -1) {\n            return;\n        }\n        const repeatTimer = this.repeating,\n            delay = this.delay,\n            exec = () => {\n                this.config.onSuccess && this.config.onSuccess();\n            };\n\n        this._schedulerID = repeatTimer ? setInterval(exec, delay) : setTimeout( () => {\n            exec();\n            this._schedulerID = -1;\n        }, delay);\n\n        return this._schedulerID;\n    }\n\n    fire(options: any, success: any, error: any) {\n        if(this.repeating) {\n            this._isFired = true;\n        }\n        return this.trigger(options, success, error);\n    }\n}"],"mappings":";;;AAAA,SAAuBA,UAAU,QAAQ,eAAe;AAMxD,OAAO,MAAMC,WAAW,SAASD,UAAU,CAAoB;EAK3DE,WAAWA,CAACC,MAAyB,EAAE;IACnC,KAAK,CAACA,MAAM,CAAC;IAACC,eAAA;IAAAA,eAAA,mBAJP,KAAK;IAAAA,eAAA,uBACI,CAAC,CAAC;IAAAA,eAAA;IAIlB,IAAI,CAACC,SAAS,GAAGF,MAAM,CAACE,SAAS;IACjC,IAAI,CAACC,KAAK,GAAGH,MAAM,CAACG,KAAK,IAAI,GAAG;EACpC;EAEAC,MAAMA,CAACC,OAAY,EAAEC,OAAY,EAAEC,KAAU,EAAE;IAC3C,KAAK,CAACH,MAAM,CAACC,OAAO,EAAEC,OAAO,EAAEC,KAAK,CAAC;IACrC,OAAO,IAAI,CAACC,IAAI,CAAC,IAAI,CAACC,MAAM,EAAEH,OAAO,EAAEC,KAAK,CAAC;EACjD;EAEAG,MAAMA,CAAA,EAAG;IACL,IAAI,IAAI,CAACC,YAAY,GAAG,CAAC,CAAC,EAAE;MACxB,IAAI,IAAI,CAACT,SAAS,EAAE;QAChBU,aAAa,CAAC,IAAI,CAACD,YAAY,CAAC;MACpC,CAAC,MAAM;QACHE,YAAY,CAAC,IAAI,CAACF,YAAY,CAAC;MACnC;MACA,IAAI,CAACA,YAAY,GAAG,CAAC,CAAC;IAC1B;EACJ;EAEAG,OAAOA,CAAA,EAAG;IACN,IAAI,CAACJ,MAAM,CAAC,CAAC;EACjB;EAEAK,KAAKA,CAAA,EAAG;IACJ,IAAI,CAACL,MAAM,CAAC,CAAC;EACjB;EAEAM,OAAOA,CAACX,OAAY,EAAEC,OAAY,EAAEC,KAAU,EAAE;IAC5C,IAAI,IAAI,CAACI,YAAY,GAAG,CAAC,CAAC,EAAE;MACxB;IACJ;IACA,MAAMM,WAAW,GAAG,IAAI,CAACf,SAAS;MAC9BC,KAAK,GAAG,IAAI,CAACA,KAAK;MAClBe,IAAI,GAAGA,CAAA,KAAM;QACT,IAAI,CAAClB,MAAM,CAACmB,SAAS,IAAI,IAAI,CAACnB,MAAM,CAACmB,SAAS,CAAC,CAAC;MACpD,CAAC;IAEL,IAAI,CAACR,YAAY,GAAGM,WAAW,GAAGG,WAAW,CAACF,IAAI,EAAEf,KAAK,CAAC,GAAGkB,UAAU,CAAE,MAAM;MAC3EH,IAAI,CAAC,CAAC;MACN,IAAI,CAACP,YAAY,GAAG,CAAC,CAAC;IAC1B,CAAC,EAAER,KAAK,CAAC;IAET,OAAO,IAAI,CAACQ,YAAY;EAC5B;EAEAH,IAAIA,CAACH,OAAY,EAAEC,OAAY,EAAEC,KAAU,EAAE;IACzC,IAAG,IAAI,CAACL,SAAS,EAAE;MACf,IAAI,CAACoB,QAAQ,GAAG,IAAI;IACxB;IACA,OAAO,IAAI,CAACN,OAAO,CAACX,OAAO,EAAEC,OAAO,EAAEC,KAAK,CAAC;EAChD;AACJ"}