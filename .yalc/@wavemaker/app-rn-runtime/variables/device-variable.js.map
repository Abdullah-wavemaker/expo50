{"version":3,"names":["BaseVariable","VariableEvents","OperationProvider","DeviceVariable","constructor","config","dataSet","isList","invoke","params","onSuccess","onError","operation","get","service","Promise","resolve","notify","BEFORE_INVOKE","then","data","SUCCESS","err","ERROR","AFTER_INVOKE"],"sources":["device-variable.ts"],"sourcesContent":["import { BaseVariable, VariableConfig, VariableEvents } from '@wavemaker/app-rn-runtime/variables/base-variable';\nimport OperationProvider, { Input, Output } from './device/operation.provider';\n\nexport interface DeviceVariableConfig extends VariableConfig {\n  service: string;\n  operation: string;\n}\n\nexport class DeviceVariable extends BaseVariable<DeviceVariableConfig> {\n\n  constructor(config: DeviceVariableConfig) {\n    super(config);\n    this.dataSet = this.isList ? [] : {};\n  }\n\n  invoke(params: any, onSuccess?: Function, onError?: Function): Promise<DeviceVariable> {\n    super.invoke(params, onSuccess, onError);\n    const operation = OperationProvider.get(`${this.config.service}.${this.config.operation}`);\n    if (!operation) {\n      return Promise.resolve(this);\n    }\n    this.notify(VariableEvents.BEFORE_INVOKE, [this, this.dataSet]);\n\n    return operation.invoke(this.params as Input, onSuccess, onError)\n      .then((data: Output) => {\n        this.dataSet = data;\n        this.config.onSuccess && this.config.onSuccess(this, this.dataSet);\n        this.notify(VariableEvents.SUCCESS, [this, this.dataSet]);\n      }, (err: Output) => {\n        this.config.onError && this.config.onError(this, null);\n        this.notify(VariableEvents.ERROR, [this, this.dataSet]);\n      }).then(() => {\n        this.notify(VariableEvents.AFTER_INVOKE, [this, this.dataSet]);\n        return this;\n    });\n  }\n}\n"],"mappings":"AAAA,SAASA,YAAY,EAAkBC,cAAc,QAAQ,mDAAmD;AAChH,OAAOC,iBAAiB,MAAyB,6BAA6B;AAO9E,OAAO,MAAMC,cAAc,SAASH,YAAY,CAAuB;EAErEI,WAAWA,CAACC,MAA4B,EAAE;IACxC,KAAK,CAACA,MAAM,CAAC;IACb,IAAI,CAACC,OAAO,GAAG,IAAI,CAACC,MAAM,GAAG,EAAE,GAAG,CAAC,CAAC;EACtC;EAEAC,MAAMA,CAACC,MAAW,EAAEC,SAAoB,EAAEC,OAAkB,EAA2B;IACrF,KAAK,CAACH,MAAM,CAACC,MAAM,EAAEC,SAAS,EAAEC,OAAO,CAAC;IACxC,MAAMC,SAAS,GAAGV,iBAAiB,CAACW,GAAG,CAAE,GAAE,IAAI,CAACR,MAAM,CAACS,OAAQ,IAAG,IAAI,CAACT,MAAM,CAACO,SAAU,EAAC,CAAC;IAC1F,IAAI,CAACA,SAAS,EAAE;MACd,OAAOG,OAAO,CAACC,OAAO,CAAC,IAAI,CAAC;IAC9B;IACA,IAAI,CAACC,MAAM,CAAChB,cAAc,CAACiB,aAAa,EAAE,CAAC,IAAI,EAAE,IAAI,CAACZ,OAAO,CAAC,CAAC;IAE/D,OAAOM,SAAS,CAACJ,MAAM,CAAC,IAAI,CAACC,MAAM,EAAWC,SAAS,EAAEC,OAAO,CAAC,CAC9DQ,IAAI,CAAEC,IAAY,IAAK;MACtB,IAAI,CAACd,OAAO,GAAGc,IAAI;MACnB,IAAI,CAACf,MAAM,CAACK,SAAS,IAAI,IAAI,CAACL,MAAM,CAACK,SAAS,CAAC,IAAI,EAAE,IAAI,CAACJ,OAAO,CAAC;MAClE,IAAI,CAACW,MAAM,CAAChB,cAAc,CAACoB,OAAO,EAAE,CAAC,IAAI,EAAE,IAAI,CAACf,OAAO,CAAC,CAAC;IAC3D,CAAC,EAAGgB,GAAW,IAAK;MAClB,IAAI,CAACjB,MAAM,CAACM,OAAO,IAAI,IAAI,CAACN,MAAM,CAACM,OAAO,CAAC,IAAI,EAAE,IAAI,CAAC;MACtD,IAAI,CAACM,MAAM,CAAChB,cAAc,CAACsB,KAAK,EAAE,CAAC,IAAI,EAAE,IAAI,CAACjB,OAAO,CAAC,CAAC;IACzD,CAAC,CAAC,CAACa,IAAI,CAAC,MAAM;MACZ,IAAI,CAACF,MAAM,CAAChB,cAAc,CAACuB,YAAY,EAAE,CAAC,IAAI,EAAE,IAAI,CAAClB,OAAO,CAAC,CAAC;MAC9D,OAAO,IAAI;IACf,CAAC,CAAC;EACJ;AACF"}